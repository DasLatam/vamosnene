---
import Base from "../../layouts/Base.astro";
const api = import.meta.env.PUBLIC_API_BASE;

const res = await fetch(`${api}/api/events`);
const data = await res.json();

function fmt(iso) {
  if (!iso) return "-";
  return new Intl.DateTimeFormat("es-AR", { dateStyle: "medium", timeStyle: "short", timeZone: "America/Argentina/Buenos_Aires" }).format(new Date(iso));
}
---
<Base title="Calendario 2026 — Vamos Nene...!!!">
  <h1>Calendario 2026</h1>
  <p class="muted">Cada evento tiene su página con sesiones + clima + links.</p>

  <div class="card">
    <h2>Eventos</h2>
    {data.events?.length ? (
      <ul>
        {data.events.map((e) => (
          <li>
            <a href={`/gp/${e.event_slug}`}>{e.event_name}</a>
            <span class="muted"> — {fmt(e.start_time)} → {fmt(e.end_time)}</span>
          </li>
        ))}
      </ul>
    ) : (
      <div class="muted">No hay eventos aún. Corré el sync admin.</div>
    )}
  </div>
</Base>
